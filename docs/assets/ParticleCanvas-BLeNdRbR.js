import{A as e,b as t,c as n,d as r,j as i,k as a,n as o,o as s,p as c,q as l,t as u,u as d,y as f,z as p}from"./index-DZnV4Szz.js";const m={id:`particles`},h={class:`bottom-group-hor`},g=[`for`],_=[`id`,`onUpdate:modelValue`],ee={class:`counts-wrapper`},te={class:`plot`},v={class:`canvas-wrapper`},y=9e9,b=1;var x=c({__name:`ParticleCanvas`,setup(t){let c=Object.freeze({RECOVERED:-1,HEALTHY:0}),x=!0,S,C=f(0),w=window.innerWidth,T=[],E,D=f({context:void 0,height:218,width:1,initialWidth:void 0,updateAfterTicks:1}),O=f({totalPart:200,radiusPart:6,maxVelocity:4,tickRate:16,duration:200,quarantineAfter:70,quarantineProb:80,movingProp:80,infectionProb:100,infectedProp:1}),k=f({healthy:200,infected:0,recovered:0,quarantined:0,total:200}),A=f({healthy:`#9c9c9c`,initiallyInfected:`#ff371c`,infected:`#ff6428`,recovered:`#21a84b`,quarantined:`#ffa30f`}),j=f({minX:0,maxX:0,minY:0,maxY:0}),M=f(),N=f(),P=f(),F=f();o(()=>{I(),R(T,E),window.addEventListener(`resize`,H.bind(this)),S=setTimeout(L,O.value.tickRate)}),r(()=>{window.removeEventListener(`resize`,H.bind(this))});function I(){ne(),C.value=0,k.value={healthy:O.value.totalPart,recovered:0,quarantined:0,infected:0,total:O.value.totalPart},T=[];for(let e=0;e<O.value.totalPart;e++){let t=Z(0,100)<=O.value.infectedProp;k.value.infected+=t?1:0;let n=Z(0,100)>=O.value.movingProp,r=Q(T,j.value.maxX,j.value.maxY,O.value.radiusPart);e+1===O.value.totalPart&&k.value.infected===0&&(t=!0,k.value.infected+=1);let i={id:e,x:r.x,y:r.y,vx:n?0:$(O.value.maxVelocity),vy:n?0:$(O.value.maxVelocity),r:O.value.radiusPart,fill:t?A.value.initiallyInfected:A.value.healthy,state:t?O.value.duration:c.HEALTHY,mass:n?y:b,collidedWith:[]};T.push(i)}}function ne(){E=F.value.getContext(`2d`),j.value.maxX=F.value.parentElement.clientWidth,j.value.maxY=F.value.parentElement.clientHeight,F.value.width=j.value.maxX,F.value.height=j.value.maxY,D.value.context=N.value.getContext(`2d`),D.value.height=M.value.clientHeight-38-13,N.value.width=4e3,N.value.height=D.value.height}function L(){if(!x.value){if(z(E,j.value.maxX,j.value.maxY),W(T),R(T,E),k.value.healthy=k.value.total-k.value.infected-k.value.recovered,C.value%D.value.updateAfterTicks===0){let e=C.value/D.value.updateAfterTicks;D.value.width+=1,P.value.scrollLeft+=1;let t=Object.assign({},k.value);t.infected-=t.quarantined,re(t,e,D.value.context,D.value.height,A.value)}C.value+=1}S=setTimeout(L.bind(this),O.value.tickRate)}function R(e,t){e.forEach(e=>{B(e.x,e.y,e.r,e.fill,t)})}function z(e,t,n){e.clearRect(0,0,t,n)}function B(e,t,n,r,i){i.fillStyle=r,i.beginPath(),i.arc(e,t,n,0,Math.PI*2),i.closePath(),i.fill()}function V(){k.value.infected===0?U(!0):x=!x}function H(e){w!==e.target.innerWidth&&(setTimeout(U.bind(this,!1),250),w=e.target.innerWidth)}function U(e){clearTimeout(S),z(D.value.context,D.value.width,D.value.height),D.value.width=1,z(E,j.value.maxX,j.value.maxY),I(),R(T,E),x=e?!1:x,S=setTimeout(L.bind(this),O.value.tickRate)}function W(e){e.forEach(e=>{e.x+=e.vx,e.y+=e.vy,e.collidedWith=[]}),e.forEach(t=>{let n=Y(e,t);n.filter(e=>!e.collidedWith.includes(t)).forEach(e=>{J(t,e),t.collidedWith.push(e)}),X(t,j.value),q(t,n,O.value.infectionProb),G(t),K(t,O.value.quarantineProb)})}function G(e){e.state>c.HEALTHY&&(--e.state,e.state===c.HEALTHY&&(e.fill===A.value.quarantined&&--k.value.quarantined,e.state=c.RECOVERED,e.fill=A.value.recovered,k.value.recovered+=1,--k.value.infected,k.value.infected===0&&(x=!0)))}function K(e,t){e.state>c.HEALTHY&&e.state<O.value.duration-O.value.quarantineAfter&&e.fill!==A.value.quarantined&&Z(0,100)<=t&&(e.mass=y,e.fill=A.value.quarantined,e.vx=0,e.vy=0,k.value.quarantined+=1)}function q(e,t,n){e.state===c.HEALTHY&&t.filter(e=>e.state>c.HEALTHY).length&&Z(0,100)<=n&&(e.state=O.value.duration,e.fill=A.value.infected,k.value.infected+=1)}function J(e,t){let n=e.vx-t.vx,r=e.vy-t.vy,i=e.x-t.x,a=e.y-t.y,o=i*n+a*r;if(o>0){let s=i*i+a*a,c=o/s,l=i*c-n,u=a*c-r,d=e.mass+t.mass,f=2*t.mass/d,p=2*e.mass/d;e.vx+=f*l,e.vy+=f*u,t.vx-=p*l,t.vy-=p*u}}function Y(e,t){return e.filter(e=>{let n=e.x-t.x,r=e.y-t.y;return e.id!==t.id&&n*n+r*r<=4*e.r*e.r})}function X(e,t){let{r:n}=e,r=Math.abs(e.x-t.minX)<n,i=Math.abs(e.x-t.maxX)<n,a=Math.abs(e.y-t.minY)<n,o=Math.abs(e.y-t.maxY)<n;r?e.x=t.minX+n:i&&(e.x=t.maxX-n),a?e.y=t.minY+n:o&&(e.y=t.maxY-n),(r||i)&&(e.vx*=-1),(a||o)&&(e.vy*=-1)}function Z(e,t){return Math.round(Math.random()*(t-e)+e)}function Q(e,t,n,r){let i=Z(r+1,t-r-1),a=Z(r+1,n-r-1);return Y(e,{x:i,y:a,r,id:-1}).length?Q(e,t,n,r):{x:i,y:a}}function $(e){let t=Z(-e,e);return t===0?$(e):t}function re(e,t,n,r,i){let a=r,o=o=>{let s=e[o]/e.total*r;a-=s,n.fillStyle=i[o],n.fillRect(t,a,1,s)};o(`healthy`),o(`recovered`),o(`quarantined`),o(`infected`)}return(t,r)=>(l(),i(`section`,m,[r[6]||=u(`h1`,null,`Particle System`,-1),u(`ul`,null,[u(`li`,null,[u(`div`,h,[u(`div`,{ref_key:`inputsWrapper`,ref:M,class:`inputs-wrapper`},[r[2]||=u(`h3`,null,`Configuration`,-1),(l(!0),i(d,null,s(O.value,(e,t)=>(l(),i(d,{key:t},[u(`label`,{for:t},p(t)+`: `,9,g),a(u(`input`,{id:t,"onUpdate:modelValue":e=>O.value[t]=e,type:`number`},null,8,_),[[n,O.value[t],void 0,{number:!0}]])],64))),128)),u(`button`,{onClick:r[0]||=e=>U(!0)},`Restart`)],512),u(`div`,ee,[r[3]||=u(`h3`,null,`Counts`,-1),(l(!0),i(d,null,s(k.value,(t,n)=>(l(),i(d,{key:n},[u(`label`,null,p(n)+`: `,1),u(`span`,{style:e({color:A.value[n]})},p(k.value[n]),5)],64))),128)),r[4]||=u(`label`,null,`time:`,-1),u(`span`,null,p(C.value),1)]),u(`div`,te,[r[5]||=u(`h3`,null,`Change over time`,-1),u(`div`,{ref_key:`plotScroller`,ref:P,class:`plot-scroller`},[u(`div`,{class:`plot-wrapper`,style:e({height:D.value.height+`px`,width:D.value.width+`px`})},[u(`canvas`,{ref_key:`plotCanvas`,ref:N},null,512)],4)],512)])]),u(`div`,v,[u(`canvas`,{ref_key:`particlesCanvas`,ref:F,onClick:r[1]||=e=>V()},null,512)])])])]))}}),S=t(x,[[`__scopeId`,`data-v-80de51b5`]]);export{S as default};